<section id="gallery" class="py-5">
  <div class="container">
    <!-- Header Section -->
    <div class="row mb-5">
      <div class="col-12 text-center">
        <h2 class="display-4 fw-bold">Our Gallery</h2>
        <p class="text-muted lead">Take a look at our workshop and completed projects</p>
        <div class="divider-custom mx-auto my-4">
          <div class="divider-custom-line bg-primary"></div>
          <div class="divider-custom-icon"><i class="fas fa-camera text-primary"></i></div>
          <div class="divider-custom-line bg-primary"></div>
        </div>
      </div>
    </div>

    <!-- Gallery Filters -->
    <div class="row mb-4">
      <div class="col-12 text-center">
        <div class="btn-group gallery-filter">
          <button class="btn btn-outline-primary active" data-filter="all">All</button>
          <button class="btn btn-outline-primary" data-filter="workshop">Workshop</button>
          <button class="btn btn-outline-primary" data-filter="repairs">Repairs</button>
          <button class="btn btn-outline-primary" data-filter="results">Results</button>
        </div>
      </div>
    </div>

    <!-- Gallery Images -->
    <div class="row g-4 gallery-container">
      <!-- Gallery Item 1 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="workshop">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery1.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery1.jpg" data-title="Workshop Area">
            <img src="images/gallery1.jpg" alt="Workshop Area" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Workshop Area</h5>
              <p class="text-white-50 small mb-0">Our main service area with modern equipment</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 2 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="repairs">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery2.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery2.jpg" data-title="Engine Overhaul">
            <img src="images/gallery2.jpg" alt="Engine Overhaul" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Engine Overhaul</h5>
              <p class="text-white-50 small mb-0">Complete engine rebuild service</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 3 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="results">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery3.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery3.jpg" data-title="Finished Project">
            <img src="images/gallery3.jpg" alt="Finished Project" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Finished Project</h5>
              <p class="text-white-50 small mb-0">Customer's car after complete restoration</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 4 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="workshop">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery4.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery4.jpg" data-title="Workshop Panorama">
            <img src="images/gallery4.jpg" alt="Workshop Panorama" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <div class="d-flex align-items-center">
                <span class="badge bg-primary me-2">Featured</span>
                <h5 class="text-white mb-0">Workshop Panorama</h5>
              </div>
              <p class="text-white-50 small mb-0">Full view of our spacious workshop</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 5 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="repairs">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery5.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery5.jpg" data-title="Brake System Repair">
            <img src="images/gallery5.jpg" alt="Brake System Repair" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Brake System Repair</h5>
              <p class="text-white-50 small mb-0">Installation of high-performance brake components</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 6 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="results">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery6.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery6.jpg" data-title="Paint Job">
            <img src="images/gallery6.jpg" alt="Paint Job" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Paint Job</h5>
              <p class="text-white-50 small mb-0">Custom paint finish after collision repair</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 7 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="workshop">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery7.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery7.jpg" data-title="Diagnostic Equipment">
            <img src="images/gallery7.jpg" alt="Diagnostic Equipment" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Diagnostic Equipment</h5>
              <p class="text-white-50 small mb-0">State-of-the-art diagnostic tools</p>
            </div>
          </a>
        </div>
      </div>

      <!-- Gallery Item 8 -->
      <div class="col-lg-4 col-md-6 col-sm-12 gallery-item" data-category="repairs">
        <div class="gallery-card position-relative overflow-hidden rounded shadow-sm">
          <a href="images/gallery8.jpg" data-bs-toggle="modal" data-bs-target="#galleryModal" data-img="images/gallery8.jpg" data-title="Engine Diagnostics">
            <img src="images/gallery8.jpg" alt="Engine Diagnostics" class="img-fluid gallery-img w-100">
            <div class="gallery-overlay d-flex flex-column justify-content-end p-3">
              <h5 class="text-white mb-1">Engine Diagnostics</h5>
              <p class="text-white-50 small mb-0">Performing advanced engine performance analysis</p>
            </div>
          </a>
        </div>
      </div>
    </div>

    <!-- Bootstrap Gallery Modal -->
    <div class="modal fade" id="galleryModal" tabindex="-1" aria-labelledby="galleryModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-xl" style="margin-bottom: 30px; max-width: 85%;">
        <div class="modal-content border-0 shadow-lg" style="border-radius: 10px; overflow: hidden;">
          <div class="modal-header bg-dark text-white">
            <h5 class="modal-title" id="galleryModalLabel">Image Title</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body p-0 position-relative bg-dark">
            <img src="" id="galleryModalImage" class="img-fluid w-100" style="max-height: 80vh; object-fit: contain;">
            <div class="position-absolute top-50 start-0 translate-middle-y">
              <button type="button" class="btn btn-dark btn-prev rounded-circle d-flex align-items-center justify-content-center opacity-75" style="width: 50px; height: 50px; margin-left: 15px; backdrop-filter: blur(3px);">
                <i class="fas fa-chevron-left fa-lg"></i>
              </button>
            </div>
            <div class="position-absolute top-50 end-0 translate-middle-y">
              <button type="button" class="btn btn-dark btn-next rounded-circle d-flex align-items-center justify-content-center opacity-75" style="width: 50px; height: 50px; margin-right: 15px; backdrop-filter: blur(3px);">
                <i class="fas fa-chevron-right fa-lg"></i>
              </button>
            </div>
            <div class="position-absolute bottom-0 start-0 end-0 py-3 bg-dark bg-opacity-75" style="backdrop-filter: blur(5px);">
              <div class="container-fluid">
                <div class="row align-items-center">
                  <div class="col-4 text-start">
                    <button type="button" class="btn btn-outline-light prev-btn">
                      <i class="fas fa-chevron-left me-1"></i> Previous
                    </button>
                  </div>
                  <div class="col-4 text-center">
                    <div class="gallery-counter text-white">
                      <span id="currentImageIndex" class="fs-5">1</span> / <span id="totalImages" class="fs-5">8</span>
                    </div>
                  </div>
                  <div class="col-4 text-end">
                    <button type="button" class="btn btn-outline-light next-btn">
                      Next <i class="fas fa-chevron-right ms-1"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Custom CSS for gallery -->
  <style>
    .divider-custom {
      width: 100%;
      max-width: 200px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .divider-custom-line {
      width: 100%;
      max-width: 35%;
      height: 4px;
      border-radius: 2px;
    }
    .divider-custom-icon {
      font-size: 1.5rem;
      margin: 0 1rem;
    }
    .gallery-card {
      transition: all 0.3s ease;
      height: 100%;
    }
    .gallery-card:hover {
      transform: translateY(-5px);
    }
    .gallery-img {
      transition: all 0.5s ease;
      height: 320px; /* Further increased fixed height for all images */
      object-fit: cover;
    }
    .gallery-card:hover .gallery-img {
      transform: scale(1.1);
    }
    .gallery-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%);
      opacity: 0;
      transition: all 0.3s ease;
    }
    .gallery-card:hover .gallery-overlay {
      opacity: 1;
    }
    .gallery-filter {
      margin-bottom: 2rem;
    }
    .gallery-filter .btn {
      border-radius: 30px;
      padding: 0.5rem 1.5rem;
      margin: 0 0.25rem;
      transition: all 0.3s ease;
    }
    .gallery-filter .btn.active {
      background-color: var(--bs-primary);
      color: white;
    }
  </style>

  <!-- Custom JS for gallery -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const filterButtons = document.querySelectorAll('.gallery-filter .btn');
      const galleryItems = document.querySelectorAll('.gallery-item');
      
      // Filter gallery items
      filterButtons.forEach(button => {
        button.addEventListener('click', function() {
          // Remove active class from all buttons
          filterButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
          
          // Get filter value
          const filterValue = this.getAttribute('data-filter');
          
          // Show/hide gallery items based on filter
          galleryItems.forEach(item => {
            if (filterValue === 'all' || item.getAttribute('data-category') === filterValue) {
              item.style.display = 'block';
            } else {
              item.style.display = 'none';
            }
          });
        });
      });

      // Bootstrap modal gallery
      const galleryModal = document.getElementById('galleryModal');
      const modalImage = document.getElementById('galleryModalImage');
      const modalTitle = document.getElementById('galleryModalLabel');
      const prevBtn = document.querySelectorAll('.prev-btn');
      const nextBtn = document.querySelectorAll('.next-btn');
      const btnPrev = document.querySelector('.btn-prev');
      const btnNext = document.querySelector('.btn-next');
      const currentImageIndexEl = document.getElementById('currentImageIndex');
      const totalImagesEl = document.getElementById('totalImages');
      let currentIndex = 0;
      const galleryLinks = document.querySelectorAll('.gallery-card a');

      // Set total images count
      if (totalImagesEl) {
        totalImagesEl.textContent = galleryLinks.length;
      }

      // Update modal with image data
      if (galleryModal) {
        galleryModal.addEventListener('show.bs.modal', function(event) {
          const link = event.relatedTarget;
          const imgSrc = link.getAttribute('data-img');
          const title = link.getAttribute('data-title');
          
          // Find current index
          galleryLinks.forEach((item, index) => {
            if (item === link) currentIndex = index;
          });
          
          updateModalContent();
        });

        // Previous button
        prevBtn.forEach(btn => {
          btn.addEventListener('click', function() {
            currentIndex = (currentIndex - 1 + galleryLinks.length) % galleryLinks.length;
            updateModalContent();
          });
        });

        // Next button
        nextBtn.forEach(btn => {
          btn.addEventListener('click', function() {
            currentIndex = (currentIndex + 1) % galleryLinks.length;
            updateModalContent();
          });
        });

        // Direct buttons on image
        if (btnPrev) {
          btnPrev.addEventListener('click', function() {
            currentIndex = (currentIndex - 1 + galleryLinks.length) % galleryLinks.length;
            updateModalContent();
          });
        }

        if (btnNext) {
          btnNext.addEventListener('click', function() {
            currentIndex = (currentIndex + 1) % galleryLinks.length;
            updateModalContent();
          });
        }

        // Keyboard navigation
        galleryModal.addEventListener('keydown', function(e) {
          if (e.key === 'ArrowLeft') {
            currentIndex = (currentIndex - 1 + galleryLinks.length) % galleryLinks.length;
            updateModalContent();
          } else if (e.key === 'ArrowRight') {
            currentIndex = (currentIndex + 1) % galleryLinks.length;
            updateModalContent();
          }
        });

        // Update modal content
        function updateModalContent() {
          const link = galleryLinks[currentIndex];
          const imgSrc = link.getAttribute('data-img');
          const title = link.getAttribute('data-title');
          
          modalImage.src = imgSrc;
          modalTitle.textContent = title;
          
          if (currentImageIndexEl) {
            currentImageIndexEl.textContent = currentIndex + 1;
          }
        }
      }
    });
  </script>
</section>